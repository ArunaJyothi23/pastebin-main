(()=>{var e={};e.id=24,e.ids=[24],e.modules={399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},517:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},9348:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-async-storage.external.js")},412:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-unit-async-storage.external.js")},4770:e=>{"use strict";e.exports=require("crypto")},8678:e=>{"use strict";e.exports=import("pg")},1940:(e,t,r)=>{"use strict";r.a(e,async(e,s)=>{try{r.r(t),r.d(t,{patchFetch:()=>c,routeModule:()=>u,serverHooks:()=>x,workAsyncStorage:()=>d,workUnitAsyncStorage:()=>l});var a=r(2412),n=r(4293),i=r(4147),o=r(382),p=e([o]);o=(p.then?(await p)():p)[0];let u=new a.AppRouteRouteModule({definition:{kind:n.RouteKind.APP_ROUTE,page:"/api/paste/route",pathname:"/api/paste",filename:"route",bundlePath:"app/api/paste/route"},resolvedPagePath:"C:\\Users\\User\\Desktop\\pastebin-main\\frontend\\app\\api\\paste\\route.ts",nextConfigOutput:"",userland:o}),{workAsyncStorage:d,workUnitAsyncStorage:l,serverHooks:x}=u;function c(){return(0,i.patchFetch)({workAsyncStorage:d,workUnitAsyncStorage:l})}s()}catch(e){s(e)}})},5303:()=>{},382:(e,t,r)=>{"use strict";r.a(e,async(e,s)=>{try{r.r(t),r.d(t,{POST:()=>p});var a=r(7856),n=r(8677),i=r(4770),o=e([n]);async function p(e){try{let t=await e.json();if(!t.content||!t.content.trim())return a.NextResponse.json({detail:"Content is required"},{status:400});let r=function(e=8){return(0,i.randomBytes)(e).toString("base64url").slice(0,e)}(8),s=new Date,o=null;t.expiresInSeconds&&t.expiresInSeconds>0&&(o=new Date(s.getTime()+1e3*t.expiresInSeconds));let p=await n.d.connect();try{await p.query("BEGIN"),await p.query("DELETE FROM pastes WHERE expires_at IS NOT NULL AND expires_at < NOW()"),await p.query("DELETE FROM pastes WHERE max_views IS NOT NULL AND view_count >= max_views"),await p.query(`INSERT INTO pastes (id, content, created_at, expires_at, max_views, view_count)
         VALUES ($1, $2, NOW(), $3, $4, 0)`,[r,t.content,o,t.maxViews??null]),await p.query("COMMIT")}catch(e){throw await p.query("ROLLBACK"),e}finally{p.release()}let c=process.env.NEXT_PUBLIC_FRONTEND_URL??process.env.VERCEL_URL??"http://localhost:3000",u="string"!=typeof c||c.startsWith("http")?`${c}/paste/${r}`:`https://${c}/paste/${r}`;return a.NextResponse.json({id:r,url:u},{status:201})}catch(e){return console.error("Error creating paste",e),a.NextResponse.json({detail:"Failed to create paste"},{status:500})}}n=(o.then?(await o)():o)[0],s()}catch(e){s(e)}})},8677:(e,t,r)=>{"use strict";r.a(e,async(e,s)=>{try{r.d(t,{d:()=>i});var a=r(8678),n=e([a]);if(a=(n.then?(await n)():n)[0],!process.env.DATABASE_URL)throw Error("DATABASE_URL env var is required for Postgres connection");let i=new a.Pool({connectionString:process.env.DATABASE_URL,max:5,idleTimeoutMillis:3e4});s()}catch(e){s(e)}})}};var t=require("../../../webpack-runtime.js");t.C(e);var r=e=>t(t.s=e),s=t.X(0,[267,814],()=>r(1940));module.exports=s})();